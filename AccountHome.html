<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @keyframes countUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .counter {
            animation: countUp 1s ease-out forwards;
        }

        .wave-pattern {
            background: repeating-linear-gradient(135deg, #4f46e5 10px, #3b82f6 20px);
            background-size: 200% 200%;
            animation: wave-animation 8s ease-in-out infinite;
        }

        @keyframes wave-animation {
            0% {
                background-position: 0% 0%;
            }

            50% {
                background-position: 100% 100%;
            }

            100% {
                background-position: 0% 0%;
            }
        }
    </style>
</head>

<body>
    <div id="sidebar-container">
    </div>
    <header class="wave-pattern p-4 text-black">
        <div class="flex justify-end p-4 space-x-4">
            <div class="relative dropdown">
                <button class="flex items-center bg-white p-2 rounded-full shadow focus:outline-none focus:ring">
                    <svg class="w-6 h-6 text-gray-700" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                        xmlns="http://www.w3.org/2000/svg">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.003 6.003 0 00-5-5.917V4a2 2 0 10-4 0v1.083A6.003 6.003 0 004 11v3.159c0 .538-.214 1.055-.595 1.436L2 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9">
                        </path>
                    </svg>
                </button>

                <!-- Notification Dropdown -->
                <div class="absolute right-0 mt-0 w-64 bg-gray-800 rounded-md shadow-lg py-2 dropdown-menu hidden z-10">
                    <a href="#" class="block px-4 py-2 text-gray-300 hover:bg-gray-700">Domain service for customer Amit
                        Paints is pending.</a>
                    <a href="#" class="block px-4 py-2 text-gray-300 hover:bg-gray-700">Invoice 12321 has due date
                        today.</a>
                    <a href="#" class="block px-4 py-2 text-gray-300 hover:bg-gray-700">95 services expiring this
                        week.</a>
                </div>
            </div>
            <div class="relative dropdown">
                <button
                    class="flex items-center space-x-2 bg-white p-2 rounded-full shadow focus:outline-none focus:ring">
                    <img src="https://via.placeholder.com/40" alt="User Avatar" class="w-8 h-8 rounded-full">
                    <span class="font-semibold">Krupali</span>
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                        xmlns="http://www.w3.org/2000/svg">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                    </svg>
                </button>

                <!-- Dropdown Menu -->
                <div class="absolute right-0 mt-1 w-48 bg-gray-800 rounded-md shadow-lg py-2 dropdown-menu hidden z-10">
                    <a href="#" class="block px-4 py-2 text-gray-300 hover:bg-gray-700">Profile</a>
                    <a href="#" class="block px-4 py-2 text-gray-300 hover:bg-gray-700">Settings</a>
                    <a href="index.html" class="block px-4 py-2 text-gray-300 hover:bg-gray-700">Logout</a>
                </div>
            </div>
        </div>
    </header>

    <!-- Page Content -->
    <div class="ml-60 p-5">
        <div class="container mx-auto">
            <div class="flex items-center mt-4">
                <h1 class="text-4xl font-bold mr-4">Dashboard for financial year</h1>
                <select id="financialYear" class="border border-gray-300 rounded-lg px-3 py-2 text-gray-700">
                    <option value="2022-2023">2024-2025</option>
                    <option value="2023-2024">2023-2024</option>
                    <option value="2024-2025">2022-2023</option>
                </select>
            </div>

            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 mt-6">
                <!-- Card 1 -->
                <div class="bg-white rounded-lg shadow-lg p-4 hover:bg-blue-50 hover:shadow-xl transition duration-300">
                    <div class="text-gray-500">Sales</div>
                    <h2 class="text-3xl font-bold text-blue-600 counter" data-target="1234">₹0</h2>
                    <p class="text-gray-400 text-sm">Current Financial Year, Updated 5s ago</p>
                </div>

                <!-- Card 2 -->
                <div class="bg-white rounded-lg shadow-lg p-4 hover:bg-blue-50 hover:shadow-xl transition duration-300">
                    <div class="text-gray-500">Outstanding</div>
                    <h2 class="text-3xl font-bold text-blue-600 counter" data-target="12345">₹0</h2>
                    <p class="text-gray-400 text-sm">Current Financial Year, Updated 5s ago</p>
                </div>

                <!-- Card 3 -->
                <div class="bg-white rounded-lg shadow-lg p-4 hover:bg-blue-50 hover:shadow-xl transition duration-300">
                    <div class="text-gray-500">Customers</div>
                    <h2 class="text-3xl font-bold text-blue-600 counter" data-target="567">0</h2>
                    <p class="text-gray-400 text-sm">Active : 300, Inactive : 267</p>
                </div>

                <!-- Card 4 -->
                <div class="bg-white rounded-lg shadow-lg p-4 hover:bg-blue-50 hover:shadow-xl transition duration-300">
                    <div class="text-gray-500">Pending Payments</div>
                    <h2 class="text-3xl font-bold text-blue-600 counter" data-target="12">0</h2>
                    <p class="text-gray-400 text-sm">Total pending payment amount : ₹12,345</p>
                </div>

            </div>

            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mt-6">
                <!-- Chart Placeholder -->
                <div class="lg:col-span-2 bg-white rounded-lg shadow-lg">
                    <div class="p-4 border-b border-gray-200 font-bold">Top 5 Customers by Transaction Amount</div>
                    <div class="p-4">
                        <canvas id="topCustomersBarChart" class="h-64"></canvas>
                    </div>
                </div>
                <div class="bg-white rounded-lg shadow-lg">
                    <div class="p-4 border-b border-gray-200 font-bold">Sales Overview</div>
                    <div class="p-4">
                        <canvas id="salesPieChart" class="h-64"></canvas>
                    </div>
                </div>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mt-6">
                <canvas id="servicesChart" width="400" height="200"></canvas>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mt-6">
                <!-- Chart Placeholder -->
                <div class="bg-white rounded-lg shadow-lg p-4">
                    <div class="border-b border-gray-200 font-bold">Services by Period</div>
                    <div class="p-4">
                        <canvas id="servicesByPeriodChart"></canvas>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://code.jquery.com/jquery-3.7.1.slim.min.js"
        integrity="sha256-kmHvs0B+OpCW5GVHUNjv9rOmY0IvSIRcf7zGUDTDQM8=" crossorigin="anonymous"></script>
    <script>
        var salesPieChart;
        var topCustomersBarChart;

        const services = ['Service A', 'Service B', 'Service C', 'Service D', 'Service E'];
        const invoiceData = [5000, 3000, 4000, 7000, 2000];
        const receiptData = [2000, 1500, 3000, 4000, 1500];
        const outstandingData = [3000, 1500, 1000, 3000, 500];

        createServicesChart(services, invoiceData, receiptData, outstandingData);

        createSalesPieChart();

        createTopCustomersBarChart();

        createServicesByPeriodChart();

        function createServicesByPeriodChart() {
            const ctx = document.getElementById('servicesByPeriodChart').getContext('2d');
            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['Service A', 'Service B', 'Service C', 'Service D'], // X-axis labels (Services)
                    datasets: [
                        {
                            label: 'Invoice Amount - Jan',
                            data: [1200, 1500, 800, 1300], // Example data for January
                            backgroundColor: 'rgba(54, 162, 235, 0.6)',
                            stack: 'Stack 0'
                        },
                        {
                            label: 'Service Count - Jan',
                            data: [12, 19, 3, 5], // Example data for January
                            backgroundColor: 'rgba(75, 192, 192, 0.6)',
                            stack: 'Stack 1'
                        },
                        {
                            label: 'Invoice Amount - Feb',
                            data: [1100, 1400, 900, 1200], // Example data for February
                            backgroundColor: 'rgba(54, 162, 235, 0.4)',
                            stack: 'Stack 0'
                        },
                        {
                            label: 'Service Count - Feb',
                            data: [10, 20, 4, 6], // Example data for February
                            backgroundColor: 'rgba(75, 192, 192, 0.4)',
                            stack: 'Stack 1'
                        },
                        // Add more datasets for other months
                    ]
                },
                options: {
                    responsive: true,
                    scales: {
                        x: {
                            title: {
                                display: true,
                                text: 'Services'
                            }
                        },
                        y: {
                            title: {
                                display: true,
                                text: 'Amount (Invoice) / Count (Services)'
                            },
                            stacked: true
                        }
                    }
                }
            });
        }

        function createSalesPieChart() {
            var ctx = document.getElementById('salesPieChart').getContext('2d');

            // Destroy existing chart if it exists
            if (salesPieChart) {
                salesPieChart.destroy();
            }

            // Create a new chart
            salesPieChart = new Chart(ctx, {
                type: 'pie',
                data: {
                    labels: ['SMM', 'SEO', 'G-Suite'],
                    datasets: [{
                        data: [300, 50, 100],
                        backgroundColor: ['#007bff', '#28a745', '#ffc107'],
                        hoverBackgroundColor: ['#0056b3', '#218838', '#e0a800'],
                        hoverBorderColor: ['#004085', '#155724', '#856404'],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    tooltips: {
                        callbacks: {
                            label: function (tooltipItem, data) {
                                var label = data.labels[tooltipItem.index] || '';
                                var value = data.datasets[tooltipItem.datasetIndex].data[tooltipItem.index];
                                if (label) {
                                    label += ': ';
                                }
                                label += value + ' units';
                                return label;
                            }
                        }
                    }
                }
            });
        }

        // Call the function to create the pie chart

        function createTopCustomersBarChart() {
            var ctx = document.getElementById('topCustomersBarChart').getContext('2d');

            // Destroy existing chart if it exists
            if (topCustomersBarChart) {
                topCustomersBarChart.destroy();
            }

            // Create a new chart
            var topCustomersBarChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['Customer A', 'Customer B', 'Customer C', 'Customer D', 'Customer E'],
                    datasets: [{
                        label: 'Transaction Amount ($)',
                        data: [1200, 950, 800, 750, 600],
                        backgroundColor: ['#007bff', '#28a745', '#ffc107', '#dc3545', '#17a2b8'],
                        hoverBackgroundColor: ['#0056b3', '#218838', '#e0a800', '#c82333', '#138496'],
                        borderColor: ['#0056b3', '#218838', '#e0a800', '#c82333', '#138496'],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    scales: {
                        yAxes: [{
                            ticks: {
                                beginAtZero: true,
                                callback: function (value) {
                                    return '$' + value;
                                }
                            },
                            scaleLabel: {
                                display: true,
                                labelString: 'Transaction Amount ($)'
                            }
                        }]
                    },
                    tooltips: {
                        callbacks: {
                            label: function (tooltipItem, data) {
                                return '$' + tooltipItem.yLabel;
                            }
                        }
                    }
                }
            });
        }

        function createServicesChart(services, invoiceData, receiptData, outstandingData) {
            const ctx = document.getElementById('servicesChart').getContext('2d');

            const servicesChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: services,
                    datasets: [
                        {
                            label: 'Invoice Amount',
                            data: invoiceData,
                            backgroundColor: 'rgba(54, 162, 235, 0.7)', // Light Blue color
                            borderColor: 'rgba(54, 162, 235, 1)',
                            borderWidth: 1
                        },
                        {
                            label: 'Receipt Amount',
                            data: receiptData,
                            backgroundColor: 'rgba(75, 192, 192, 0.7)', // Light Green color
                            borderColor: 'rgba(75, 192, 192, 1)',
                            borderWidth: 1
                        },
                        {
                            label: 'Outstanding Amount',
                            data: outstandingData,
                            backgroundColor: 'rgba(255, 99, 132, 0.7)', // Light Red color
                            borderColor: 'rgba(255, 99, 132, 1)',
                            borderWidth: 1
                        }
                    ]
                },
                options: {
                    scales: {
                        x: {
                            stacked: true, // Stack the bars horizontally
                            title: {
                                display: true,
                                text: 'Services'
                            }
                        },
                        y: {
                            stacked: true, // Stack the bars vertically
                            title: {
                                display: true,
                                text: 'Amount'
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            position: 'top'
                        },
                        tooltip: {
                            mode: 'index',
                            intersect: false
                        }
                    },
                    responsive: true,
                    maintainAspectRatio: false
                }
            });
        }

        const sidebarContainer = document.getElementById("sidebar-container");
        fetch("./Sidebar.html")
            .then(response => {
                if (!response.ok) {
                    throw new Error("Network response was not ok");
                }
                return response.text();
            })
            .then(html => {
                sidebarContainer.innerHTML = html;

                // Extract and execute scripts
                const scripts = sidebarContainer.querySelectorAll("script");
                scripts.forEach(script => {
                    const newScript = document.createElement("script");
                    newScript.text = script.innerHTML;
                    document.body.appendChild(newScript);
                });
            })
            .catch(error => {
                console.error("There was a problem with the fetch operation:", error);
            });

        document.addEventListener('DOMContentLoaded', function () {
            // Select all elements that need the counter animation
            const counters = document.querySelectorAll('.counter');

            counters.forEach(counter => {
                // Get the target number from the text content
                let target = parseInt(counter.getAttribute('data-target'), 10);

                // Animate from 0 to the target number
                let count = 0;
                const increment = target / 100; // Adjust the increment value as needed

                const updateCount = () => {
                    if (count < target) {
                        count += increment;
                        counter.textContent = `${Math.round(count)}`; // Adjust the formatting as needed
                        setTimeout(updateCount, 10);
                    } else {
                        counter.textContent = `${target}`; // Ensure it ends exactly at target
                    }
                };

                // Start the count up animation
                updateCount();

                // Add the counter class to trigger CSS animation
                counter.classList.add('counter');
            });
        });

    </script>

</body>

</html>